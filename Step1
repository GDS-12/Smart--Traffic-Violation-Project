##Step 1 — Import Required Libraries
import os
import zipfile
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')

##Step 2 — Load the CSV Data
#Loading and exploring the dataset
df=pd.read_csv('/content/Indian_Traffic_Violations.csv')
df.head() #showing first five rows.
df.tail() #showing last five rows.

##Step 3 — Understand Dataset Structure
df.info() #shows column names, data types and missing values.
df.describe() #shows summary statistics of numerical columns.
df.isnull().sum() #shows count of missing (null) values.

#very important to check missing & Duplicate data: missing values can cause incorrect calculations or error in data models because the dataset become incomplete.
#Similarly, duplicate data can make results biased like counting the same person or transaction twice.
#This gives misleading insights and affects the accuracy of our analysis or ML model.

df.duplicated().sum() #shows count of duplicate rows.

df.shape #shows number of rows and columns.
df.dtypes #shows data types of each column.

##Step 4 — Data Cleaning and Preprocessing

# Drop duplicates
df.drop_duplicates(inplace=True)

# Handle missing values (example: fill NAs or drop rows)
df.dropna(subset=['Date', 'Time'], inplace=True)

# Convert date and time columns if available
df['Date'] = pd.to_datetime(df['Date'], errors='coerce')
if 'Time' in df.columns:
    df['Time'] = pd.to_datetime(df['Time'], errors='coerce').dt.time

# Extract useful time-based features
df['Day'] = df['Date'].dt.day_name()
df['Month'] = df['Date'].dt.month_name()
df['Hour'] = pd.to_datetime(df['Date']).dt.hour

print("Data cleaned and new columns added!")
df.head()

##Step 5 — Exploratory Data Analysis (EDA)
# Total violations per day
plt.figure(figsize=(12,5))  #create a new blank chart area of size 10,5. it define width and height of the bar graph.
df['Day'].value_counts().plot(kind='bar', color='skyblue') #Takes the day column from the dataframe(df).Count how many times each day.
                                                           #Plots those counts as a bar chart.Each bar represents one day of the week.
                                                           #The height of each bar=number of violations that day.color skyblue makes bars visually appealing.
plt.title('Violations by Day of Week') #Add a title to the chart- helps understand what the visualization represents.
plt.xlabel('Day of Week')   #Day of week like Mon-sun.
plt.ylabel('Count')         #count number of violations.
plt.show()                  #display the final char.

# Violations by Month
plt.figure(figsize=(12,5))
df['Month'].value_counts().plot(kind='bar', color='orange')
plt.title('Violations by Month')
plt.xlabel('Month')
plt.ylabel('Count')
plt.show()

##Step 6 — Violation Type Analysis
#check if column exists.
#df.columns: lists all the columns names in your dataframe.
if 'Violation_Type' in df.columns:  #Return ture if this columns is present.
    plt.figure(figsize=(12,5))
    sns.countplot(y='Violation_Type', data=df, order=df['Violation_Type'].value_counts().index[:10])  #countplot() automaticallycounts the number of occurrances of each category.
                                                                                                      #plot violation types on the y axis. each horizontal bar represents one type of traffic violations.
                                                                                                      #data=df using that our data is coming from the dataframe name df.
                                                                                                      #order=df['Violation_Type'].value_counts() Using because counts how many times each type appears.
                                                                                                      #.index[:10] using select the top 10 most common type.sorted by frequency.
    plt.title('Top 10 Violation Types')
    plt.xlabel('Count') #showing the number of violations in x-axis.
    plt.ylabel('Violation Type')#showing the violation type categories in y-axis.
    plt.show() # display the final visualizations.

##Step 7 — Time-based Violation Pattern Detection

# Violation trends by hour of day
if 'Hour' in df.columns:
    plt.figure(figsize=(12,5))
    sns.countplot(x='Hour', data=df, color='salmon')
    plt.title('Traffic Violations by Hour of Day')
    plt.xlabel('Hour')
    plt.ylabel('Count')
    plt.show()


# Heatmap: Violations by Day vs Hour
if 'Day' in df.columns and 'Hour' in df.columns:
    pivot = df.pivot_table(index='Day', columns='Hour', aggfunc='size', fill_value=0)
    plt.figure(figsize=(12,6))
    sns.heatmap(pivot, cmap='YlOrBr')
    plt.title('Heatmap: Violations by Day and Hour')
    plt.show()

##Step 8 — Hotspot Detection (Top Locations)
if 'Location' in df.columns:
    top_locations = df['Location'].value_counts().head(10)
    plt.figure(figsize=(12,5))
    sns.barplot(x=top_locations.values, y=top_locations.index, palette='viridis')
    plt.title('Top 10 Violation Hotspots')
    plt.xlabel('Number of Violations')
    plt.ylabel('Location')
    plt.show()

##Step 9 — Summary Insights
print("Total Violations Recorded:", len(df))
if 'Violation_Type' in df.columns:
    print("Most Common Violation Type:", df['Violation_Type'].mode()[0])
if 'Location' in df.columns:
    print("Top Hotspot Location:", df['Location'].mode()[0])
if 'Day' in df.columns:
    print("Day with Most Violations:", df['Day'].mode()[0])
